import{a as b,r as T,h as F,o as V,c as f,b as a,d as o,b7 as S,w as n,V as r,ae as z,b8 as _,a8 as g,U as w,J as D,aa as A,ac as h,ax as B,e as $,f as m}from"./index.a1351669.js";import{V as q}from"./VTable.406e9dbf.js";import{V as E}from"./VDialog.ffa0cb7c.js";import{V as N,a as u}from"./VTextField.96136ffc.js";import{V as M,b as P,a as J,c as L}from"./VCard.29189499.js";import{V as j}from"./VContainer.a35e5c4c.js";import{V as G}from"./VFileInput.acbb437c.js";import{V as x}from"./VTextarea.2ab52c3a.js";import{V as H}from"./VSpacer.3edbb3f5.js";/* empty css              */import"./VChip.9a267c2d.js";const K={class:"container mt-5"},O={id:"teachers"},Q={class:"row"},R=a("div",{class:"col-12"},[a("h1",{class:"text-center"},"\u8001\u5E2B\u7BA1\u7406")],-1),W={class:"col-12"},X=m("\u65B0\u589E\u8001\u5E2B"),Y={class:"col-12"},Z=a("thead",null,[a("tr",null,[a("th",null,"\u59D3\u540D"),a("th",null,"\u5716\u7247"),a("th",null,"\u7814\u7A76\u5BA4"),a("th",null,"\u96FB\u8A71"),a("th",{colspan:"2"},"\u7BA1\u7406")])],-1),ee=m("\u7DE8\u8F2F"),le=m("\u522A\u9664"),te={key:1},ae=a("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u8001\u5E2B ",-1),oe=[ae],se={class:"text-h5"},ie={class:"row"},ne={class:"col-12 col-md-4"},de={class:"col-12 col-md-4"},re={class:"col-12 col-md-4"},ue={class:"col-12 col-md-4"},me={class:"col-12 col-md-4"},ce={class:"col-12 col-md-4"},pe={class:"col-12"},Ve={class:"col-12"},fe={class:"col-12"},_e=m("\u53D6\u6D88"),ge=m("\u78BA\u5B9A"),ze={__name:"TeachersView",setup(he){const i=b([]),c=10,p=T(1),k=F(()=>i.slice(p.value*c-c,p.value*c)),l=b({_id:"",name:"",proInterest:"",experience:"",course:"",lab:"",telephone:"",fax:"",email:"",image:[],idx:-1,dialog:!1,valid:!1,submitting:!1}),v=b({required(s){return!!s||"\u5FC5\u586B"},size(s){var e,t,d;return!s||!s.length||((t=(e=s[0])==null?void 0:e.type)==null?void 0:t.includes("image"))&&((d=s[0])==null?void 0:d.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),y=(s,e)=>{l._id=s,e>-1?(l.name=i[e].name,l.proInterest=i[e].proInterest,l.experience=i[e].experience,l.course=i[e].course,l.lab=i[e].lab,l.email=i[e].email,l.telephone=i[e].telephone,l.fax=i[e].fax):(l.name="",l.proInterest="",l.experience="",l.course="",l.email="",l.lab="",l.telephone="",l.fax=""),l.image=[],l.idx=e,l.dialog=!0,l.valid=!1,l.submitting=!1},U=async(s,e)=>{await _.delete("/teachers/"+s),i.splice(e,1)},C=async()=>{if(!l.valid)return;l.submitting=!0;const s=new FormData;for(const e in l)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?s.append(e,l[e][0]):s.append(e,l[e]));try{if(l._id.length===0){const{data:e}=await _.post("/teachers",s);i.push(e.teacher),g.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await _.patch("/teachers/"+l._id,s);i[l.idx]=e.teacher,g.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(e){g.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}l.submitting=!1};return(async()=>{try{const{data:s}=await _.get("/teachers/all");s.teacher.map(e=>{const t=(e.image="https://taishanim.herokuapp.com/files/"+e.image,e);i.push(t)})}catch(s){g.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,e)=>(V(),f("div",K,[a("div",O,[a("div",Q,[R,o(S),a("div",W,[o(r,{color:"blue darken-4",onClick:e[0]||(e[0]=t=>y("",-1))},{default:n(()=>[X]),_:1})]),a("div",Y,[o(q,null,{default:n(()=>[Z,a("tbody",null,[w(k).length>0?(V(!0),f(D,{key:0},A(w(k),(t,d)=>(V(),f("tr",{key:t._id},[a("td",null,h(t.name),1),a("td",null,[o(B,{src:t.image},null,8,["src"])]),a("td",null,h(t.lab),1),a("td",null,h(t.telephone),1),a("td",null,[o(r,{color:"blue darken-4",onClick:I=>y(t._id,d),variant:"outlined"},{default:n(()=>[ee]),_:2},1032,["onClick"])]),a("td",null,[o(r,{color:"error",onClick:I=>U(t._id,d),variant:"outlined"},{default:n(()=>[le]),_:2},1032,["onClick"])])]))),128)):(V(),f("tr",te,oe))])]),_:1})])]),o(E,{modelValue:l.dialog,"onUpdate:modelValue":e[12]||(e[12]=t=>l.dialog=t),scrollable:""},{default:n(()=>[o(N,{modelValue:l.valid,"onUpdate:modelValue":e[11]||(e[11]=t=>l.valid=t),onSubmit:$(C,["prevent"]),style:{height:"900px",width:"100%"}},{default:n(()=>[o(M,null,{default:n(()=>[o(P,null,{default:n(()=>[a("div",se,h(l._id.length>0?"\u7DE8\u8F2F\u8001\u5E2B":"\u65B0\u589E\u8001\u5E2B"),1)]),_:1}),o(J,null,{default:n(()=>[o(j,null,{default:n(()=>[a("div",ie,[a("div",ne,[o(u,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.name=t),label:"\u8001\u5E2B\u59D3\u540D",rules:[v.required],variant:"outlined"},null,8,["modelValue","rules"])]),a("div",de,[o(G,{modelValue:l.image,"onUpdate:modelValue":e[2]||(e[2]=t=>l.image=t),"show-size":"",accept:"image/*",label:"\u5716\u7247","prepend-icon":"",rules:[v.size],variant:"outlined"},null,8,["modelValue","rules"])]),a("div",re,[o(u,{modelValue:l.lab,"onUpdate:modelValue":e[3]||(e[3]=t=>l.lab=t),label:"\u7814\u7A76\u5BA4",variant:"outlined"},null,8,["modelValue"])]),a("div",ue,[o(u,{modelValue:l.telephone,"onUpdate:modelValue":e[4]||(e[4]=t=>l.telephone=t),label:"\u96FB\u8A71",variant:"outlined"},null,8,["modelValue"])]),a("div",me,[o(u,{modelValue:l.fax,"onUpdate:modelValue":e[5]||(e[5]=t=>l.fax=t),label:"\u50B3\u771F",variant:"outlined"},null,8,["modelValue"])]),a("div",ce,[o(u,{modelValue:l.email,"onUpdate:modelValue":e[6]||(e[6]=t=>l.email=t),label:"\u4FE1\u7BB1",rules:[v.required],variant:"outlined"},null,8,["modelValue","rules"])]),a("div",pe,[o(x,{modelValue:l.experience,"onUpdate:modelValue":e[7]||(e[7]=t=>l.experience=t),label:"\u7D93\u6B77",variant:"outlined"},null,8,["modelValue"])]),a("div",Ve,[o(x,{modelValue:l.proInterest,"onUpdate:modelValue":e[8]||(e[8]=t=>l.proInterest=t),label:"\u5C08\u696D\u8208\u8DA3",variant:"outlined"},null,8,["modelValue"])]),a("div",fe,[o(x,{modelValue:l.course,"onUpdate:modelValue":e[9]||(e[9]=t=>l.course=t),label:"\u8AB2\u7A0B",variant:"outlined"},null,8,["modelValue"])])])]),_:1})]),_:1}),o(L,null,{default:n(()=>[o(H),o(r,{color:"error",onClick:e[10]||(e[10]=t=>l.dialog=!1),disabled:l.submitting},{default:n(()=>[_e]),_:1},8,["disabled"]),o(r,{type:"submit",color:"primary",loading:l.submitting},{default:n(()=>[ge]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"]),o(z,{modelValue:p.value,"onUpdate:modelValue":e[13]||(e[13]=t=>p.value=t),length:Math.ceil(i.length/c),rounded:"circle","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])])]))}};export{ze as default};
