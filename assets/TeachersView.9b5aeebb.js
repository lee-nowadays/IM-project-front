import{a as x,r as S,h as z,o as V,c as g,b as s,d as t,w as o,af as D,b8 as _,a9 as b,a7 as A,V as u,U as C,J as B,ab as $,ad as h,ay as q,e as E,f as p}from"./index.d3155321.js";import{V as U,a as r}from"./VRow.a9226739.js";import{V as N}from"./VDialog.4164ee34.js";import{V as M}from"./VTable.8850330a.js";import{V as P,a as m}from"./VTextField.c2425db8.js";import{V as J,b as L,a as R,c as j}from"./VCard.a5570dd6.js";import{V as G}from"./VContainer.1979ea84.js";import{V as H}from"./VFileInput.8ca53db1.js";import{V as y}from"./VTextarea.4113dd43.js";import{V as K}from"./VSpacer.72589e93.js";/* empty css              */import"./VChip.8f3daee5.js";const O={class:"container mt-5"},Q={id:"teachers"},W=s("h1",{class:"text-center"},"\u8001\u5E2B\u7BA1\u7406",-1),X=p("\u65B0\u589E\u8001\u5E2B"),Y=s("thead",null,[s("tr",null,[s("th",null,"\u59D3\u540D"),s("th",null,"\u5716\u7247"),s("th",null,"\u7814\u7A76\u5BA4"),s("th",null,"\u96FB\u8A71"),s("th",{colspan:"2"},"\u7BA1\u7406")])],-1),Z=p("\u7DE8\u8F2F"),ee=p("\u522A\u9664"),le={key:1},te=s("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u8001\u5E2B ",-1),ae=[te],oe={class:"text-h5"},ne=p("\u53D6\u6D88"),se=p("\u78BA\u5B9A"),xe={__name:"TeachersView",setup(ie){const i=x([]),c=10,f=S(1),k=z(()=>i.slice(f.value*c-c,f.value*c)),l=x({_id:"",name:"",proInterest:"",experience:"",course:"",lab:"",telephone:"",fax:"",email:"",image:[],idx:-1,dialog:!1,valid:!1,submitting:!1}),v=x({required(n){return!!n||"\u5FC5\u586B"},size(n){var e,a,d;return!n||!n.length||((a=(e=n[0])==null?void 0:e.type)==null?void 0:a.includes("image"))&&((d=n[0])==null?void 0:d.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),w=(n,e)=>{l._id=n,e>-1?(l.name=i[e].name,l.proInterest=i[e].proInterest,l.experience=i[e].experience,l.course=i[e].course,l.lab=i[e].lab,l.email=i[e].email,l.telephone=i[e].telephone,l.fax=i[e].fax):(l.name="",l.proInterest="",l.experience="",l.course="",l.email="",l.lab="",l.telephone="",l.fax=""),l.image=[],l.idx=e,l.dialog=!0,l.valid=!1,l.submitting=!1},I=async(n,e)=>{await _.delete("/teachers/"+n),i.splice(e,1)},T=async()=>{if(!l.valid)return;l.submitting=!0;const n=new FormData;for(const e in l)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?n.append(e,l[e][0]):n.append(e,l[e]));try{if(l._id.length===0){const{data:e}=await _.post("/teachers",n);i.push(e.teacher),b.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await _.patch("/teachers/"+l._id,n);i[l.idx]=e.teacher,b.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(e){b.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}l.submitting=!1};return(async()=>{try{const{data:n}=await _.get("/teachers/all");n.teacher.map(e=>{const a=(e.image="https://taishanim.herokuapp.com/files/"+e.image,e);i.push(a)})}catch(n){b.fire({icon:"error",title:"\u5931\u6557",text:n.isAxiosError?n.response.data.message:n.message})}})(),(n,e)=>(V(),g("div",O,[s("div",Q,[t(U,null,{default:o(()=>[t(r,{cols:"12"},{default:o(()=>[W]),_:1}),t(A),t(r,{cols:"12"},{default:o(()=>[t(u,{color:"success",onClick:e[0]||(e[0]=a=>w("",-1))},{default:o(()=>[X]),_:1})]),_:1}),t(r,{cols:"12"},{default:o(()=>[t(M,null,{default:o(()=>[Y,s("tbody",null,[C(k).length>0?(V(!0),g(B,{key:0},$(C(k),(a,d)=>(V(),g("tr",{key:a._id},[s("td",null,h(a.name),1),s("td",null,[t(q,{src:a.image},null,8,["src"])]),s("td",null,h(a.lab),1),s("td",null,h(a.telephone),1),s("td",null,[t(u,{color:"blue darken-4",onClick:F=>w(a._id,d),variant:"outlined"},{default:o(()=>[Z]),_:2},1032,["onClick"])]),s("td",null,[t(u,{color:"error",onClick:F=>I(a._id,d),variant:"outlined"},{default:o(()=>[ee]),_:2},1032,["onClick"])])]))),128)):(V(),g("tr",le,ae))])]),_:1})]),_:1})]),_:1}),t(N,{modelValue:l.dialog,"onUpdate:modelValue":e[12]||(e[12]=a=>l.dialog=a),scrollable:""},{default:o(()=>[t(P,{modelValue:l.valid,"onUpdate:modelValue":e[11]||(e[11]=a=>l.valid=a),onSubmit:E(T,["prevent"]),style:{height:"900px",width:"100%"}},{default:o(()=>[t(J,null,{default:o(()=>[t(L,null,{default:o(()=>[s("div",oe,h(l._id.length>0?"\u7DE8\u8F2F\u8001\u5E2B":"\u65B0\u589E\u8001\u5E2B"),1)]),_:1}),t(R,null,{default:o(()=>[t(G,null,{default:o(()=>[t(U,null,{default:o(()=>[t(r,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.name=a),label:"\u8001\u5E2B\u59D3\u540D",rules:[v.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(H,{modelValue:l.image,"onUpdate:modelValue":e[2]||(e[2]=a=>l.image=a),"show-size":"",accept:"image/*",label:"\u5716\u7247","prepend-icon":"",rules:[v.size],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.lab,"onUpdate:modelValue":e[3]||(e[3]=a=>l.lab=a),label:"\u7814\u7A76\u5BA4",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.telephone,"onUpdate:modelValue":e[4]||(e[4]=a=>l.telephone=a),label:"\u96FB\u8A71",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.fax,"onUpdate:modelValue":e[5]||(e[5]=a=>l.fax=a),label:"\u50B3\u771F",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.email,"onUpdate:modelValue":e[6]||(e[6]=a=>l.email=a),label:"\u4FE1\u7BB1",rules:[v.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:o(()=>[t(y,{modelValue:l.experience,"onUpdate:modelValue":e[7]||(e[7]=a=>l.experience=a),label:"\u7D93\u6B77",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12"},{default:o(()=>[t(y,{modelValue:l.proInterest,"onUpdate:modelValue":e[8]||(e[8]=a=>l.proInterest=a),label:"\u5C08\u696D\u8208\u8DA3",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(r,{cols:"12"},{default:o(()=>[t(y,{modelValue:l.course,"onUpdate:modelValue":e[9]||(e[9]=a=>l.course=a),label:"\u8AB2\u7A0B",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(j,null,{default:o(()=>[t(K),t(u,{color:"error",onClick:e[10]||(e[10]=a=>l.dialog=!1),disabled:l.submitting},{default:o(()=>[ne]),_:1},8,["disabled"]),t(u,{type:"submit",color:"primary",loading:l.submitting},{default:o(()=>[se]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"]),t(D,{modelValue:f.value,"onUpdate:modelValue":e[13]||(e[13]=a=>f.value=a),length:Math.ceil(i.length/c),rounded:"circle","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])])]))}};export{xe as default};
