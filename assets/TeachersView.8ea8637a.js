import{a as _,r as S,h as $,o as r,c as f,b as a,d as s,b7 as z,w as n,V as m,ae as B,b8 as h,a8 as g,U as T,J as D,aa as A,ac as v,ax as E,ab as b,e as N,f as c}from"./index.d7eba916.js";import{e as q}from"./isEmail.74bf80b5.js";import{V as M}from"./VTable.1d24a57b.js";import{V as P}from"./VDialog.a46231a2.js";import{V as J,a as V}from"./VTextField.7e832c8f.js";import{V as L,b as j,a as G,c as H}from"./VCard.3791b39b.js";import{V as K}from"./VFileInput.f7b96526.js";import{V as y}from"./VTextarea.6a057198.js";import{V as O}from"./VSpacer.a8ca7173.js";import"./VChip.fe0800a5.js";const Q={class:"container mt-5"},R={id:"adminTeachers"},W={class:"row"},X=a("div",{class:"col-12"},[a("h1",{class:"text-center"},"\u8001\u5E2B\u7BA1\u7406")],-1),Y={class:"col-12"},Z=c("\u65B0\u589E\u8001\u5E2B"),ee={class:"col-12"},le=a("thead",null,[a("tr",null,[a("th",null,"\u59D3\u540D"),a("th",null,"\u5716\u7247"),a("th",null,"\u7814\u7A76\u5BA4"),a("th",null,"\u96FB\u8A71"),a("th",{colspan:"2"},"\u7BA1\u7406")])],-1),te=c("\u7DE8\u8F2F"),ae=c("\u7DE8\u8F2F"),oe=c("\u522A\u9664"),se=c("\u522A\u9664"),ie={key:1},ne=a("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u8001\u5E2B ",-1),de=[ne],re={class:"text-h5"},ue={class:"container"},me={class:"row"},ce={class:"col-12 col-md-4"},pe={class:"col-12 col-md-4"},Ve={class:"col-12 col-md-4"},_e={class:"col-12 col-md-4"},fe={class:"col-12 col-md-4"},he={class:"col-12 col-md-4"},ge={class:"col-12"},ve={class:"col-12"},be={class:"col-12"},ke=c("\u53D6\u6D88"),xe=c("\u78BA\u5B9A"),Ae={__name:"TeachersView",setup(ye){const i=_([]),p=10,d=S(1),w=$(()=>i.slice(d.value*p-p,d.value*p)),l=_({_id:"",name:"",proInterest:"",experience:"",course:"",lab:"",telephone:"",fax:"",email:"",image:[],idx:-1,dialog:!1,valid:!1,submitting:!1}),C=_({required(o){return!!o||"\u5FC5\u586B"},size(o){var e,t,u;return!o||!o.length||((t=(e=o[0])==null?void 0:e.type)==null?void 0:t.includes("image"))&&((u=o[0])==null?void 0:u.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),I=_({email:[o=>!!o||"\u4FE1\u7BB1\u5FC5\u586B",o=>q(o)||"\u4FE1\u7BB1\u683C\u5F0F\u932F\u8AA4"]}),k=(o,e)=>{l._id=o,e>-1?(l.name=i[e].name,l.proInterest=i[e].proInterest,l.experience=i[e].experience,l.course=i[e].course,l.lab=i[e].lab,l.email=i[e].email,l.telephone=i[e].telephone,l.fax=i[e].fax):(l.name="",l.proInterest="",l.experience="",l.course="",l.email="",l.lab="",l.telephone="",l.fax=""),l.image=[],l.idx=e,l.dialog=!0,l.valid=!1,l.submitting=!1},U=async(o,e)=>{await h.delete("/teachers/"+o),i.splice(e,1)},F=async()=>{if(!l.valid)return;l.submitting=!0;const o=new FormData;for(const e in l)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?o.append(e,l[e][0]):o.append(e,l[e]));try{if(l._id.length===0){const{data:e}=await h.post("/teachers",o),t=(e.teacher.image="https://taishanim.onrender.com/files/"+e.teacher.image,e);i.push(t.teacher),g.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await h.patch("/teachers/"+l._id,o),t=(e.teacher.image="https://taishanim.onrender.com/files/"+e.teacher.image,e);i[l.idx]=t.teacher,g.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(e){g.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}l.submitting=!1};return(async()=>{try{const{data:o}=await h.get("/teachers/all");o.teacher.map(e=>{const t=(e.image="https://taishanim.onrender.com/files/"+e.image,e);i.push(t)})}catch(o){g.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,e)=>(r(),f("div",Q,[a("div",R,[a("div",W,[X,s(z),a("div",Y,[s(m,{class:"text-white",color:"blue darken-4",onClick:e[0]||(e[0]=t=>k("",-1))},{default:n(()=>[Z]),_:1})]),a("div",ee,[s(M,null,{default:n(()=>[le,a("tbody",null,[T(w).length>0?(r(!0),f(D,{key:0},A(T(w),(t,u)=>(r(),f("tr",{key:t._id},[a("td",null,v(t.name),1),a("td",null,[s(E,{src:t.image},null,8,["src"])]),a("td",null,v(t.lab),1),a("td",null,v(t.telephone),1),a("td",null,[d.value===1?(r(),b(m,{key:0,color:"blue darken-4",onClick:x=>k(t._id,u),variant:"outlined"},{default:n(()=>[te]),_:2},1032,["onClick"])):(r(),b(m,{key:1,color:"blue darken-4",onClick:x=>k(t._id,u+(d.value-1)*p),variant:"outlined"},{default:n(()=>[ae]),_:2},1032,["onClick"]))]),a("td",null,[d.value===1?(r(),b(m,{key:0,color:"error",onClick:x=>U(t._id,u),variant:"outlined"},{default:n(()=>[oe]),_:2},1032,["onClick"])):(r(),b(m,{key:1,color:"error",onClick:x=>U(t._id,u+(d.value-1)*p),variant:"outlined"},{default:n(()=>[se]),_:2},1032,["onClick"]))])]))),128)):(r(),f("tr",ie,de))])]),_:1})])]),s(P,{modelValue:l.dialog,"onUpdate:modelValue":e[12]||(e[12]=t=>l.dialog=t),scrollable:""},{default:n(()=>[s(J,{modelValue:l.valid,"onUpdate:modelValue":e[11]||(e[11]=t=>l.valid=t),onSubmit:N(F,["prevent"]),style:{height:"900px",width:"100%"}},{default:n(()=>[s(L,{class:"adminForm"},{default:n(()=>[s(j,null,{default:n(()=>[a("div",re,v(l._id.length>0?"\u7DE8\u8F2F\u8001\u5E2B":"\u65B0\u589E\u8001\u5E2B"),1)]),_:1}),s(G,null,{default:n(()=>[a("div",ue,[a("div",me,[a("div",ce,[s(V,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.name=t),label:"\u8001\u5E2B\u59D3\u540D",rules:[C.required],variant:"outlined"},null,8,["modelValue","rules"])]),a("div",pe,[s(K,{modelValue:l.image,"onUpdate:modelValue":e[2]||(e[2]=t=>l.image=t),"show-size":"",accept:"image/*",label:"\u5716\u7247","prepend-icon":"",rules:[C.size],variant:"outlined"},null,8,["modelValue","rules"])]),a("div",Ve,[s(V,{modelValue:l.lab,"onUpdate:modelValue":e[3]||(e[3]=t=>l.lab=t),label:"\u7814\u7A76\u5BA4",variant:"outlined"},null,8,["modelValue"])]),a("div",_e,[s(V,{modelValue:l.telephone,"onUpdate:modelValue":e[4]||(e[4]=t=>l.telephone=t),label:"\u96FB\u8A71",variant:"outlined"},null,8,["modelValue"])]),a("div",fe,[s(V,{modelValue:l.fax,"onUpdate:modelValue":e[5]||(e[5]=t=>l.fax=t),label:"\u50B3\u771F",variant:"outlined"},null,8,["modelValue"])]),a("div",he,[s(V,{modelValue:l.email,"onUpdate:modelValue":e[6]||(e[6]=t=>l.email=t),label:"\u4FE1\u7BB1",rules:I.email,variant:"outlined"},null,8,["modelValue","rules"])]),a("div",ge,[s(y,{modelValue:l.experience,"onUpdate:modelValue":e[7]||(e[7]=t=>l.experience=t),label:"\u7D93\u6B77",variant:"outlined"},null,8,["modelValue"])]),a("div",ve,[s(y,{modelValue:l.proInterest,"onUpdate:modelValue":e[8]||(e[8]=t=>l.proInterest=t),label:"\u5C08\u696D\u8208\u8DA3",variant:"outlined"},null,8,["modelValue"])]),a("div",be,[s(y,{modelValue:l.course,"onUpdate:modelValue":e[9]||(e[9]=t=>l.course=t),label:"\u8AB2\u7A0B",variant:"outlined"},null,8,["modelValue"])])])])]),_:1}),s(H,null,{default:n(()=>[s(O),s(m,{color:"error",onClick:e[10]||(e[10]=t=>l.dialog=!1),disabled:l.submitting},{default:n(()=>[ke]),_:1},8,["disabled"]),s(m,{type:"submit",color:"blue darken-4",loading:l.submitting},{default:n(()=>[xe]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"]),s(B,{modelValue:d.value,"onUpdate:modelValue":e[13]||(e[13]=t=>d.value=t),length:Math.ceil(i.length/p),rounded:"circle","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])])]))}};export{Ae as default};
