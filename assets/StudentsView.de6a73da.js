import{a as g,o as V,c as p,b as d,d as t,w as a,b7 as _,a9 as b,a7 as I,V as m,N as w,ab as x,ad as c,e as U,f}from"./index.c47fcb49.js";import{V as A,a as r}from"./VRow.6eb2ba18.js";import{V as q}from"./VDialog.9bff8993.js";import{V as S}from"./VTable.29e3a14c.js";import{V as D,a as i}from"./VTextField.7061357d.js";import{V as F,b as T,a as B,c as N}from"./VCard.d3aab103.js";import{V as $}from"./VContainer.72a1b127.js";import{V as E}from"./VSpacer.99ee7ba1.js";const L={class:"container mt-5"},M={id:"students"},R=d("h1",{class:"text-center"},"\u5B78\u751F\u7BA1\u7406",-1),j=f("\u65B0\u589E\u5B78\u751F"),z=d("thead",null,[d("tr",null,[d("th",null,"\u5B78\u865F"),d("th",null,"\u73ED\u7D1A"),d("th",null,"\u59D3\u540D"),d("th",null,"\u96FB\u8A71"),d("th",{colspan:"2"},"\u7BA1\u7406")])],-1),G=f("\u7DE8\u8F2F"),H=f("\u522A\u9664"),J={key:1},K=d("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u5B78\u751F ",-1),O=[K],P={class:"text-h5"},Q=f("\u53D6\u6D88"),W=f("\u78BA\u5B9A"),ne={__name:"StudentsView",setup(X){const n=g([]),e=g({_id:"",studentId:"",name:"",class:"",phone:"",residenceAddress:"",currentAddress:"",personalId:"",email:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),u=g({required(o){return!!o||"\u5FC5\u586B"}}),v=(o,l)=>{e._id=o,l>-1?(e.studentId=n[l].studentId,e.name=n[l].name,e.class=n[l].class,e.phone=n[l].phone,e.residenceAddress=n[l].residenceAddress,e.currentAddress=n[l].currentAddress,e.personalId=n[l].personalId,e.email=n[l].email):(e.studentId="",e.name="",e.class="",e.phone="",e.residenceAddress="",e.currentAddress="",e.personalId="",e.email=""),e.idx=l,e.dialog=!0,e.valid=!1,e.submitting=!1},y=async(o,l)=>{await _.delete("/students/"+o),n.splice(l,1)},k=async()=>{if(!e.valid)return;e.submitting=!0;const o=new FormData;for(const l in e)["_id","idx","dialog","valid","submitting"].includes(l)||o.append(l,e[l]);try{if(e._id.length===0){const{data:l}=await _.post("/students",o);n.push(l.student),b.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await _.patch("/students/"+e._id,o);n[e.idx]=l.student,b.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(l){b.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}e.submitting=!1};return(async()=>{try{const{data:o}=await _.get("/students/all");n.push(...o.student)}catch(o){b.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}})(),(o,l)=>(V(),p("div",L,[d("div",M,[t(A,null,{default:a(()=>[t(r,{cols:"12"},{default:a(()=>[R]),_:1}),t(I),t(r,{cols:"12"},{default:a(()=>[t(m,{color:"success",onClick:l[0]||(l[0]=s=>v("",-1))},{default:a(()=>[j]),_:1})]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(S,null,{default:a(()=>[z,d("tbody",null,[n.length>0?(V(!0),p(w,{key:0},x(n,(s,h)=>(V(),p("tr",{key:s._id},[d("td",null,c(s.studentId),1),d("td",null,c(s.class),1),d("td",null,c(s.name),1),d("td",null,c(s.phone),1),d("td",null,[t(m,{color:"blue darken-4",onClick:C=>v(s._id,h),variant:"outlined"},{default:a(()=>[G]),_:2},1032,["onClick"])]),d("td",null,[t(m,{color:"error",onClick:C=>y(s._id,h),variant:"outlined"},{default:a(()=>[H]),_:2},1032,["onClick"])])]))),128)):(V(),p("tr",J,O))])]),_:1})]),_:1})]),_:1}),t(q,{modelValue:e.dialog,"onUpdate:modelValue":l[11]||(l[11]=s=>e.dialog=s),scrollable:""},{default:a(()=>[t(D,{modelValue:e.valid,"onUpdate:modelValue":l[10]||(l[10]=s=>e.valid=s),onSubmit:U(k,["prevent"]),style:{height:"900px",width:"100%"}},{default:a(()=>[t(F,null,{default:a(()=>[t(T,null,{default:a(()=>[d("div",P,c(e._id.length>0?"\u7DE8\u8F2F\u5B78\u751F":"\u65B0\u589E\u5B78\u751F"),1)]),_:1}),t(B,null,{default:a(()=>[t($,null,{default:a(()=>[t(A,null,{default:a(()=>[t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.studentId,"onUpdate:modelValue":l[1]||(l[1]=s=>e.studentId=s),label:"\u5B78\u865F",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.personalId,"onUpdate:modelValue":l[2]||(l[2]=s=>e.personalId=s),label:"\u8EAB\u4EFD\u8B49\u5B57\u865F",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.name,"onUpdate:modelValue":l[3]||(l[3]=s=>e.name=s),label:"\u59D3\u540D",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.class,"onUpdate:modelValue":l[4]||(l[4]=s=>e.class=s),label:"\u73ED\u7D1A",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.phone,"onUpdate:modelValue":l[5]||(l[5]=s=>e.phone=s),label:"\u624B\u6A5F",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.residenceAddress,"onUpdate:modelValue":l[6]||(l[6]=s=>e.residenceAddress=s),label:"\u6236\u7C4D\u5730\u5740",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.currentAddress,"onUpdate:modelValue":l[7]||(l[7]=s=>e.currentAddress=s),label:"\u806F\u7D61\u5730\u5740",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.email,"onUpdate:modelValue":l[8]||(l[8]=s=>e.email=s),label:"\u4FE1\u7BB1",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(N,null,{default:a(()=>[t(E),t(m,{color:"error",onClick:l[9]||(l[9]=s=>e.dialog=!1),disabled:e.submitting},{default:a(()=>[Q]),_:1},8,["disabled"]),t(m,{type:"submit",color:"primary",loading:e.submitting},{default:a(()=>[W]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])])]))}};export{ne as default};
