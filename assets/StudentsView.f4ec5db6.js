import{a as h,r as q,h as S,o as _,c as g,b as n,d as t,w as a,af as D,b8 as b,a9 as v,a7 as F,V as m,U as I,J as T,ab as $,ad as c,e as B,f}from"./index.d3155321.js";import{V as k,a as r}from"./VRow.a9226739.js";import{V as E}from"./VDialog.4164ee34.js";import{V as N}from"./VTable.8850330a.js";import{V as M,a as i}from"./VTextField.c2425db8.js";import{V as P,b as z,a as J,c as L}from"./VCard.a5570dd6.js";import{V as R}from"./VContainer.1979ea84.js";import{V as j}from"./VSpacer.72589e93.js";/* empty css              */const G={class:"container mt-5"},H={id:"students"},K=n("h1",{class:"text-center"},"\u5B78\u751F\u7BA1\u7406",-1),O=f("\u65B0\u589E\u5B78\u751F"),Q=n("thead",null,[n("tr",null,[n("th",null,"\u5B78\u865F"),n("th",null,"\u73ED\u7D1A"),n("th",null,"\u59D3\u540D"),n("th",null,"\u96FB\u8A71"),n("th",{colspan:"2"},"\u7BA1\u7406")])],-1),W=f("\u7DE8\u8F2F"),X=f("\u522A\u9664"),Y={key:1},Z=n("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u5B78\u751F ",-1),ee=[Z],le={class:"text-h5"},te=f("\u53D6\u6D88"),se=f("\u78BA\u5B9A"),Ve={__name:"StudentsView",setup(ae){const o=h([]),p=10,V=q(1),A=S(()=>o.slice(V.value*p-p,V.value*p)),e=h({_id:"",studentId:"",name:"",class:"",phone:"",residenceAddress:"",currentAddress:"",personalId:"",email:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),u=h({studentId(d){/^[0-9]+$/.test(d),d.length>=8&&d.length<=8},required(d){return!!d||"\u5FC5\u586B"}}),x=(d,l)=>{e._id=d,l>-1?(e.studentId=o[l].studentId,e.name=o[l].name,e.class=o[l].class,e.phone=o[l].phone,e.residenceAddress=o[l].residenceAddress,e.currentAddress=o[l].currentAddress,e.personalId=o[l].personalId,e.email=o[l].email):(e.studentId="",e.name="",e.class="",e.phone="",e.residenceAddress="",e.currentAddress="",e.personalId="",e.email=""),e.idx=l,e.dialog=!0,e.valid=!1,e.submitting=!1},C=async(d,l)=>{await b.delete("/students/"+d),o.splice(l,1)},w=async()=>{if(!e.valid)return;e.submitting=!0;const d=new FormData;for(const l in e)["_id","idx","dialog","valid","submitting"].includes(l)||d.append(l,e[l]);try{if(e._id.length===0){const{data:l}=await b.post("/students",d);o.push(l.student),v.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await b.patch("/students/"+e._id,d);o[e.idx]=l.student,v.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(l){v.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}e.submitting=!1};return(async()=>{try{const{data:d}=await b.get("/students/all");o.push(...d.student)}catch(d){v.fire({icon:"error",title:"\u5931\u6557",text:d.isAxiosError?d.response.data.message:d.message})}})(),(d,l)=>(_(),g("div",G,[n("div",H,[t(k,null,{default:a(()=>[t(r,{cols:"12"},{default:a(()=>[K]),_:1}),t(F),t(r,{cols:"12"},{default:a(()=>[t(m,{color:"success",onClick:l[0]||(l[0]=s=>x("",-1))},{default:a(()=>[O]),_:1})]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(N,null,{default:a(()=>[Q,n("tbody",null,[I(A).length>0?(_(!0),g(T,{key:0},$(I(A),(s,y)=>(_(),g("tr",{key:s._id},[n("td",null,c(s.studentId),1),n("td",null,c(s.class),1),n("td",null,c(s.name),1),n("td",null,c(s.phone),1),n("td",null,[t(m,{color:"blue darken-4",onClick:U=>x(s._id,y),variant:"outlined"},{default:a(()=>[W]),_:2},1032,["onClick"])]),n("td",null,[t(m,{color:"error",onClick:U=>C(s._id,y),variant:"outlined"},{default:a(()=>[X]),_:2},1032,["onClick"])])]))),128)):(_(),g("tr",Y,ee))])]),_:1})]),_:1})]),_:1}),t(E,{modelValue:e.dialog,"onUpdate:modelValue":l[11]||(l[11]=s=>e.dialog=s),scrollable:""},{default:a(()=>[t(M,{modelValue:e.valid,"onUpdate:modelValue":l[10]||(l[10]=s=>e.valid=s),onSubmit:B(w,["prevent"]),style:{height:"900px",width:"100%"}},{default:a(()=>[t(P,null,{default:a(()=>[t(z,null,{default:a(()=>[n("div",le,c(e._id.length>0?"\u7DE8\u8F2F\u5B78\u751F":"\u65B0\u589E\u5B78\u751F"),1)]),_:1}),t(J,null,{default:a(()=>[t(R,null,{default:a(()=>[t(k,null,{default:a(()=>[t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.studentId,"onUpdate:modelValue":l[1]||(l[1]=s=>e.studentId=s),label:"\u5B78\u865F",rules:[u.required],variant:"outlined",counter:"8",maxlength:"8"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.personalId,"onUpdate:modelValue":l[2]||(l[2]=s=>e.personalId=s),label:"\u8EAB\u4EFD\u8B49\u5B57\u865F",rules:[u.required],variant:"outlined",counter:"10",maxlength:"10"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.name,"onUpdate:modelValue":l[3]||(l[3]=s=>e.name=s),label:"\u59D3\u540D",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.class,"onUpdate:modelValue":l[4]||(l[4]=s=>e.class=s),label:"\u73ED\u7D1A",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.phone,"onUpdate:modelValue":l[5]||(l[5]=s=>e.phone=s),label:"\u624B\u6A5F",rules:[u.required],variant:"outlined",counter:"10",maxlength:"10"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.residenceAddress,"onUpdate:modelValue":l[6]||(l[6]=s=>e.residenceAddress=s),label:"\u6236\u7C4D\u5730\u5740",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12",md:"6"},{default:a(()=>[t(i,{modelValue:e.currentAddress,"onUpdate:modelValue":l[7]||(l[7]=s=>e.currentAddress=s),label:"\u806F\u7D61\u5730\u5740",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(r,{cols:"12"},{default:a(()=>[t(i,{modelValue:e.email,"onUpdate:modelValue":l[8]||(l[8]=s=>e.email=s),label:"\u4FE1\u7BB1",rules:[u.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1}),t(L,null,{default:a(()=>[t(j),t(m,{color:"error",onClick:l[9]||(l[9]=s=>e.dialog=!1),disabled:e.submitting},{default:a(()=>[te]),_:1},8,["disabled"]),t(m,{type:"submit",color:"primary",loading:e.submitting},{default:a(()=>[se]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"]),t(D,{modelValue:V.value,"onUpdate:modelValue":l[12]||(l[12]=s=>V.value=s),length:Math.ceil(o.length/p),rounded:"circle","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])])]))}};export{Ve as default};
