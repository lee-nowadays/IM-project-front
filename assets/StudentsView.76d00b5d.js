import{a as h,r as C,h as U,o as _,c as f,b as s,d as o,b7 as q,w as n,V as u,ae as S,b8 as v,a8 as g,U as x,J as D,aa as F,ac as c,e as T,f as m}from"./index.a1351669.js";import{V as $}from"./VTable.406e9dbf.js";import{V as B}from"./VDialog.ffa0cb7c.js";import{V as E,a as r}from"./VTextField.96136ffc.js";import{V as N,b as M,a as P,c as z}from"./VCard.29189499.js";import{V as J}from"./VContainer.a35e5c4c.js";import{V as L}from"./VSpacer.3edbb3f5.js";/* empty css              */const j={class:"container mt-5"},G={id:"students"},H={class:"row"},K=s("div",{class:"col-12"},[s("h1",{class:"text-center"},"\u5B78\u751F\u7BA1\u7406")],-1),O={class:"col-12"},Q=m("\u65B0\u589E\u5B78\u751F"),R={class:"col-12"},W=s("thead",null,[s("tr",null,[s("th",null,"\u5B78\u865F"),s("th",null,"\u73ED\u7D1A"),s("th",null,"\u59D3\u540D"),s("th",null,"\u96FB\u8A71"),s("th",{colspan:"2"},"\u7BA1\u7406")])],-1),X=m("\u7DE8\u8F2F"),Y=m("\u522A\u9664"),Z={key:1},ee=s("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u5B78\u751F ",-1),le=[ee],te={class:"text-h5"},se={class:"row"},oe={class:"col-12"},de={class:"col-12"},ae={class:"col-12"},ne={class:"col-12 col-md-6"},ie={class:"col-12 col-md-6"},re={class:"col-12 col-md-6"},ue={class:"col-12 col-md-6"},ce={class:"col-12"},me=m("\u53D6\u6D88"),pe=m("\u78BA\u5B9A"),ye={__name:"StudentsView",setup(Ve){const a=h([]),p=10,V=C(1),b=U(()=>a.slice(V.value*p-p,V.value*p)),e=h({_id:"",studentId:"",name:"",class:"",phone:"",residenceAddress:"",currentAddress:"",personalId:"",email:"",idx:-1,dialog:!1,valid:!1,submitting:!1}),i=h({studentId(d){/^[0-9]+$/.test(d),d.length>=8&&d.length<=8},required(d){return!!d||"\u5FC5\u586B"}}),A=(d,l)=>{e._id=d,l>-1?(e.studentId=a[l].studentId,e.name=a[l].name,e.class=a[l].class,e.phone=a[l].phone,e.residenceAddress=a[l].residenceAddress,e.currentAddress=a[l].currentAddress,e.personalId=a[l].personalId,e.email=a[l].email):(e.studentId="",e.name="",e.class="",e.phone="",e.residenceAddress="",e.currentAddress="",e.personalId="",e.email=""),e.idx=l,e.dialog=!0,e.valid=!1,e.submitting=!1},y=async(d,l)=>{await v.delete("/students/"+d),a.splice(l,1)},I=async()=>{if(!e.valid)return;e.submitting=!0;const d=new FormData;for(const l in e)["_id","idx","dialog","valid","submitting"].includes(l)||d.append(l,e[l]);try{if(e._id.length===0){const{data:l}=await v.post("/students",d);a.push(l.student),g.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await v.patch("/students/"+e._id,d);a[e.idx]=l.student,g.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(l){g.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}e.submitting=!1};return(async()=>{try{const{data:d}=await v.get("/students/all");a.push(...d.student)}catch(d){g.fire({icon:"error",title:"\u5931\u6557",text:d.isAxiosError?d.response.data.message:d.message})}})(),(d,l)=>(_(),f("div",j,[s("div",G,[s("div",H,[K,o(q),s("div",O,[o(u,{color:"blue darken-4",onClick:l[0]||(l[0]=t=>A("",-1))},{default:n(()=>[Q]),_:1})]),s("div",R,[o($,null,{default:n(()=>[W,s("tbody",null,[x(b).length>0?(_(!0),f(D,{key:0},F(x(b),(t,k)=>(_(),f("tr",{key:t._id},[s("td",null,c(t.studentId),1),s("td",null,c(t.class),1),s("td",null,c(t.name),1),s("td",null,c(t.phone),1),s("td",null,[o(u,{color:"blue darken-4",onClick:w=>A(t._id,k),variant:"outlined"},{default:n(()=>[X]),_:2},1032,["onClick"])]),s("td",null,[o(u,{color:"error",onClick:w=>y(t._id,k),variant:"outlined"},{default:n(()=>[Y]),_:2},1032,["onClick"])])]))),128)):(_(),f("tr",Z,le))])]),_:1})])]),o(B,{modelValue:e.dialog,"onUpdate:modelValue":l[11]||(l[11]=t=>e.dialog=t),scrollable:""},{default:n(()=>[o(E,{modelValue:e.valid,"onUpdate:modelValue":l[10]||(l[10]=t=>e.valid=t),onSubmit:T(I,["prevent"]),style:{height:"900px",width:"100%"}},{default:n(()=>[o(N,null,{default:n(()=>[o(M,null,{default:n(()=>[s("div",te,c(e._id.length>0?"\u7DE8\u8F2F\u5B78\u751F":"\u65B0\u589E\u5B78\u751F"),1)]),_:1}),o(P,null,{default:n(()=>[o(J,null,{default:n(()=>[s("div",se,[s("div",oe,[o(r,{modelValue:e.studentId,"onUpdate:modelValue":l[1]||(l[1]=t=>e.studentId=t),label:"\u5B78\u865F",rules:[i.required],variant:"outlined",counter:"8",maxlength:"8"},null,8,["modelValue","rules"])]),s("div",de,[o(r,{modelValue:e.personalId,"onUpdate:modelValue":l[2]||(l[2]=t=>e.personalId=t),label:"\u8EAB\u4EFD\u8B49\u5B57\u865F",rules:[i.required],variant:"outlined",counter:"10",maxlength:"10"},null,8,["modelValue","rules"])]),s("div",ae,[o(r,{modelValue:e.name,"onUpdate:modelValue":l[3]||(l[3]=t=>e.name=t),label:"\u59D3\u540D",rules:[i.required],variant:"outlined"},null,8,["modelValue","rules"])]),s("div",ne,[o(r,{modelValue:e.class,"onUpdate:modelValue":l[4]||(l[4]=t=>e.class=t),label:"\u73ED\u7D1A",rules:[i.required],variant:"outlined"},null,8,["modelValue","rules"])]),s("div",ie,[o(r,{modelValue:e.phone,"onUpdate:modelValue":l[5]||(l[5]=t=>e.phone=t),label:"\u624B\u6A5F",rules:[i.required],variant:"outlined",counter:"10",maxlength:"10"},null,8,["modelValue","rules"])]),s("div",re,[o(r,{modelValue:e.residenceAddress,"onUpdate:modelValue":l[6]||(l[6]=t=>e.residenceAddress=t),label:"\u6236\u7C4D\u5730\u5740",rules:[i.required],variant:"outlined"},null,8,["modelValue","rules"])]),s("div",ue,[o(r,{modelValue:e.currentAddress,"onUpdate:modelValue":l[7]||(l[7]=t=>e.currentAddress=t),label:"\u806F\u7D61\u5730\u5740",rules:[i.required],variant:"outlined"},null,8,["modelValue","rules"])]),s("div",ce,[o(r,{modelValue:e.email,"onUpdate:modelValue":l[8]||(l[8]=t=>e.email=t),label:"\u4FE1\u7BB1",rules:[i.required],variant:"outlined"},null,8,["modelValue","rules"])])])]),_:1})]),_:1}),o(z,null,{default:n(()=>[o(L),o(u,{color:"error",onClick:l[9]||(l[9]=t=>e.dialog=!1),disabled:e.submitting},{default:n(()=>[me]),_:1},8,["disabled"]),o(u,{type:"submit",color:"primary",loading:e.submitting},{default:n(()=>[pe]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"]),o(S,{modelValue:V.value,"onUpdate:modelValue":l[12]||(l[12]=t=>V.value=t),length:Math.ceil(a.length/p),rounded:"circle","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left"},null,8,["modelValue","length"])])]))}};export{ye as default};
