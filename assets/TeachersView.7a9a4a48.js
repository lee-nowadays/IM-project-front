import{a as h,o as c,c as f,b as n,d as t,w as o,b8 as V,a9 as _,a7 as U,V as u,N as I,ab as T,ad as g,ay as F,e as D,f as p}from"./index.62a58031.js";import{V as y,a as d}from"./VRow.268838cb.js";import{V as S}from"./VDialog.7d31a20a.js";import{V as z}from"./VTable.2b543c2e.js";import{V as A,a as m}from"./VTextField.63a6398b.js";import{V as B,b as N,a as $,c as q}from"./VCard.81114303.js";import{V as E}from"./VContainer.9798928d.js";import{V as L}from"./VFileInput.72f80206.js";import{V as v}from"./VTextarea.7a93de01.js";import{V as M}from"./VSpacer.c4ca8cfd.js";import"./VChip.1d5d3de6.js";const R={class:"container mt-5"},j={id:"teachers"},G=n("h1",{class:"text-center"},"\u8001\u5E2B\u7BA1\u7406",-1),H=p("\u65B0\u589E\u8001\u5E2B"),J=n("thead",null,[n("tr",null,[n("th",null,"\u59D3\u540D"),n("th",null,"\u5716\u7247"),n("th",null,"\u7814\u7A76\u5BA4"),n("th",null,"\u96FB\u8A71"),n("th",{colspan:"2"},"\u7BA1\u7406")])],-1),K=p("\u7DE8\u8F2F"),O=p("\u522A\u9664"),P={key:1},Q=n("td",{class:"text-center",colspan:"5"},"\u6C92\u6709\u8001\u5E2B ",-1),W=[Q],X={class:"text-h5"},Y=p("\u53D6\u6D88"),Z=p("\u78BA\u5B9A"),ce={__name:"TeachersView",setup(ee){const i=h([]),l=h({_id:"",name:"",proInterest:"",experience:"",course:"",lab:"",telephone:"",fax:"",email:"",image:[],idx:-1,dialog:!1,valid:!1,submitting:!1}),b=h({required(s){return!!s||"\u5FC5\u586B"},size(s){var e,a,r;return!s||!s.length||((a=(e=s[0])==null?void 0:e.type)==null?void 0:a.includes("image"))&&((r=s[0])==null?void 0:r.size)<1024*1024||"\u6A94\u6848\u683C\u5F0F\u4E0D\u7B26"}}),x=(s,e)=>{l._id=s,e>-1?(l.name=i[e].name,l.proInterest=i[e].proInterest,l.experience=i[e].experience,l.course=i[e].course,l.lab=i[e].lab,l.email=i[e].email,l.telephone=i[e].telephone,l.fax=i[e].fax):(l.name="",l.proInterest="",l.experience="",l.course="",l.email="",l.lab="",l.telephone="",l.fax=""),l.image=[],l.idx=e,l.dialog=!0,l.valid=!1,l.submitting=!1},k=async(s,e)=>{await V.delete("/teachers/"+s),i.splice(e,1)},w=async()=>{if(!l.valid)return;l.submitting=!0;const s=new FormData;for(const e in l)["_id","idx","dialog","valid","submitting"].includes(e)||(e==="image"?s.append(e,l[e][0]):s.append(e,l[e]));try{if(l._id.length===0){const{data:e}=await V.post("/teachers",s);i.push(e.teacher),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await V.patch("/teachers/"+l._id,s);i[l.idx]=e.teacher,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}l.dialog=!1}catch(e){_.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}l.submitting=!1};return(async()=>{try{const{data:s}=await V.get("/teachers/all");s.teacher.map(e=>{const a=(e.image="https://taishanim.herokuapp.com/files/"+e.image,e);i.push(a)})}catch(s){_.fire({icon:"error",title:"\u5931\u6557",text:s.isAxiosError?s.response.data.message:s.message})}})(),(s,e)=>(c(),f("div",R,[n("div",j,[t(y,null,{default:o(()=>[t(d,{cols:"12"},{default:o(()=>[G]),_:1}),t(U),t(d,{cols:"12"},{default:o(()=>[t(u,{color:"success",onClick:e[0]||(e[0]=a=>x("",-1))},{default:o(()=>[H]),_:1})]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(z,null,{default:o(()=>[J,n("tbody",null,[i.length>0?(c(!0),f(I,{key:0},T(i,(a,r)=>(c(),f("tr",{key:a._id},[n("td",null,g(a.name),1),n("td",null,[t(F,{src:a.image},null,8,["src"])]),n("td",null,g(a.lab),1),n("td",null,g(a.telephone),1),n("td",null,[t(u,{color:"blue darken-4",onClick:C=>x(a._id,r),variant:"outlined"},{default:o(()=>[K]),_:2},1032,["onClick"])]),n("td",null,[t(u,{color:"error",onClick:C=>k(a._id,r),variant:"outlined"},{default:o(()=>[O]),_:2},1032,["onClick"])])]))),128)):(c(),f("tr",P,W))])]),_:1})]),_:1})]),_:1}),t(S,{modelValue:l.dialog,"onUpdate:modelValue":e[12]||(e[12]=a=>l.dialog=a),scrollable:""},{default:o(()=>[t(A,{modelValue:l.valid,"onUpdate:modelValue":e[11]||(e[11]=a=>l.valid=a),onSubmit:D(w,["prevent"]),style:{height:"900px",width:"100%"}},{default:o(()=>[t(B,null,{default:o(()=>[t(N,null,{default:o(()=>[n("div",X,g(l._id.length>0?"\u7DE8\u8F2F\u8001\u5E2B":"\u65B0\u589E\u8001\u5E2B"),1)]),_:1}),t($,null,{default:o(()=>[t(E,null,{default:o(()=>[t(y,null,{default:o(()=>[t(d,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.name=a),label:"\u8001\u5E2B\u59D3\u540D",rules:[b.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(L,{modelValue:l.image,"onUpdate:modelValue":e[2]||(e[2]=a=>l.image=a),"show-size":"",accept:"image/*",label:"\u5716\u7247","prepend-icon":"",rules:[b.size],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.lab,"onUpdate:modelValue":e[3]||(e[3]=a=>l.lab=a),label:"\u7814\u7A76\u5BA4",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.telephone,"onUpdate:modelValue":e[4]||(e[4]=a=>l.telephone=a),label:"\u96FB\u8A71",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.fax,"onUpdate:modelValue":e[5]||(e[5]=a=>l.fax=a),label:"\u50B3\u771F",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12",md:"4"},{default:o(()=>[t(m,{modelValue:l.email,"onUpdate:modelValue":e[6]||(e[6]=a=>l.email=a),label:"\u4FE1\u7BB1",rules:[b.required],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(v,{modelValue:l.experience,"onUpdate:modelValue":e[7]||(e[7]=a=>l.experience=a),label:"\u7D93\u6B77",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(v,{modelValue:l.proInterest,"onUpdate:modelValue":e[8]||(e[8]=a=>l.proInterest=a),label:"\u5C08\u696D\u8208\u8DA3",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(d,{cols:"12"},{default:o(()=>[t(v,{modelValue:l.course,"onUpdate:modelValue":e[9]||(e[9]=a=>l.course=a),label:"\u8AB2\u7A0B",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(q,null,{default:o(()=>[t(M),t(u,{color:"error",onClick:e[10]||(e[10]=a=>l.dialog=!1),disabled:l.submitting},{default:o(()=>[Y]),_:1},8,["disabled"]),t(u,{type:"submit",color:"primary",loading:l.submitting},{default:o(()=>[Z]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1},8,["modelValue"])])]))}};export{ce as default};
